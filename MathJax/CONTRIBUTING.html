<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.290">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Taopj@sh.cn's Blog – contributing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/tau3.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "没有结果",
    "search-matching-documents-text": "匹配的文档",
    "search-copy-link-title": "复制搜索链接",
    "search-hide-matches-text": "隐藏其它匹配结果",
    "search-more-match-text": "更多匹配结果",
    "search-more-matches-text": "更多匹配结果",
    "search-clear-button-title": "清除",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "提交"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images\tau3.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Taopj@sh.cn’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">关于</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#contributing-to-mathjax" id="toc-contributing-to-mathjax" class="nav-link active" data-scroll-target="#contributing-to-mathjax">Contributing to MathJax</a>
  <ul class="collapse">
  <li><a href="#reporting-an-issue" id="toc-reporting-an-issue" class="nav-link" data-scroll-target="#reporting-an-issue">Reporting An Issue</a>
  <ul class="collapse">
  <li><a href="#bug-reports" id="toc-bug-reports" class="nav-link" data-scroll-target="#bug-reports">Bug Reports</a></li>
  <li><a href="#feature-requests" id="toc-feature-requests" class="nav-link" data-scroll-target="#feature-requests">Feature Requests</a></li>
  <li><a href="#change-requests" id="toc-change-requests" class="nav-link" data-scroll-target="#change-requests">Change Requests</a></li>
  </ul></li>
  <li><a href="#working-on-mathjax-core" id="toc-working-on-mathjax-core" class="nav-link" data-scroll-target="#working-on-mathjax-core">Working on MathJax core</a>
  <ul class="collapse">
  <li><a href="#key-branches-tags" id="toc-key-branches-tags" class="nav-link" data-scroll-target="#key-branches-tags">Key Branches &amp; Tags</a></li>
  <li><a href="#submitting-pull-requests" id="toc-submitting-pull-requests" class="nav-link" data-scroll-target="#submitting-pull-requests">Submitting Pull Requests</a></li>
  <li><a href="#testing-and-quality-assurance" id="toc-testing-and-quality-assurance" class="nav-link" data-scroll-target="#testing-and-quality-assurance">Testing and Quality Assurance</a></li>
  <li><a href="#writing-documentation" id="toc-writing-documentation" class="nav-link" data-scroll-target="#writing-documentation">Writing documentation</a></li>
  <li><a href="#translation" id="toc-translation" class="nav-link" data-scroll-target="#translation">Translation</a></li>
  </ul></li>
  <li><a href="#conduct" id="toc-conduct" class="nav-link" data-scroll-target="#conduct">Conduct</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="contributing-to-mathjax" class="level1">
<h1>Contributing to MathJax</h1>
<p>You are interested in giving us a hand? That’s awesome! We’ve put together some brief guidelines that should help you get started quickly and easily.</p>
<p>There are lots and lots of ways to get involved, this document covers:</p>
<ul>
<li><a href="#reporting-an-issue">reporting an issue</a>
<ul>
<li><a href="#bug-reports">bug reports</a></li>
<li><a href="#feature-requests">feature requests</a></li>
<li><a href="#change-requests">change requests</a></li>
</ul></li>
<li><a href="#working-on-mathjax-core">working on MathJax core</a>
<ul>
<li><a href="#key-branches--tags">key branches and tags</a></li>
<li><a href="#submitting-pull-requests">submitting pull requests</a></li>
<li><a href="#testing-and-quality-assurance">testing and quality assurance</a></li>
<li><a href="#writing-documentation">writing documentation</a></li>
<li><a href="#translation">translation</a></li>
</ul></li>
<li><a href="#conduct">Conduct</a></li>
</ul>
<section id="reporting-an-issue" class="level2">
<h2 class="anchored" data-anchor-id="reporting-an-issue">Reporting An Issue</h2>
<p>If you’re about to raise an issue because you think you’ve found a problem with MathJax, or you’d like to make a request for a new feature in the codebase, or any other reason, please read this first.</p>
<p>The <a href="https://github.com/mathjax/MathJax/issues">MathJax issue tracker</a> is the preferred channel for <a href="#bug-reports">bug reports</a>, <a href="#feature-requests">feature requests</a>, <a href="#change-requests">change requests</a>, and <a href="#submitting-pull-requests">submitting pull requests</a>, but please respect the following restrictions:</p>
<ul>
<li><p>Please <strong>search for existing issues</strong>. Help us keep duplicate issues to a minimum by checking to see if someone has already reported your problem or requested your idea.</p></li>
<li><p>Please <strong>do not</strong> use the issue tracker for personal support requests (use <a href="https://groups.google.com/forum/#!forum/mathjax-users">the MathJax User Group</a>).</p></li>
<li><p>Please <strong>be civil</strong>. Keep the discussion on topic and respect the opinions of others. See also our <a href="#conduct">Conduct Guidelines</a></p></li>
</ul>
<section id="bug-reports" class="level3">
<h3 class="anchored" data-anchor-id="bug-reports">Bug Reports</h3>
<p>A bug is a <em>demonstrable problem</em> that is caused by the code in the repository. Good bug reports are extremely helpful — thank you!</p>
<p>Guidelines for bug reports:</p>
<ol type="1">
<li><p><strong>Use the GitHub issue search</strong> — check if the issue has already been reported.</p></li>
<li><p><strong>Check if the issue has been fixed</strong> — look for <a href="https://github.com/mathjax/MathJax/issues?q=is%3Aclosed">closed issues in the current milestone</a> or try to reproduce it using the latest <code>develop</code> branch. Please note that you will need to <a href="https://docs.mathjax.org/en/latest/web/hosting.html#getting-mathjax-via-git">compile MathJax and make the components</a> in order to test MathJax from the source repository.</p></li>
<li><p><strong>Share a live sample of the problem</strong> — without a live page it is usually impossible to debug problems; see also the <a href="#template">Bug Report Template</a> below.</p></li>
<li><p><strong>Isolate the problem</strong> — a live sample is a starting point but if you want to speed things up, create a <a href="https://css-tricks.com/reduced-test-cases/">reduced test case</a>. Be specific about your setup (browser, OS versions, etc). Use services like <a href="http://jsbin.com">jsbin</a>, <a href="http://codepen.io">CodePen</a>, or <a href="http://jsfiddle.com">jsFiddle</a> to make collaboration on minimal test cases easier for everyone.</p></li>
<li><p><strong>Include a screenshot/cast as a last resort</strong> — Is your issue about a layout or design feature or bug that is hard to reproduce or isolate? Then please provide a screenshot or screencast. Tools like <a href="http://www.cockos.com/licecap/">LICEcap</a> or <a href="http://www.saucelabs.com">SauceLabs</a> allow you to quickly and easily record a screencasts. If you make it an animated gif, you can embed it directly into your GitHub issue.</p></li>
<li><p>Use the <a href="#template">Bug Report Template</a> below or <a href="https://github.com/MathJax/MathJax/issues/new?title=Bug%3A&amp;body=%23%23%23%20Issue%20Summary%0A%0A%23%23%23%20Steps%20to%20Reproduce%0A%0A1.%20This%20is%20the%20first%20step%0A%0AThis%20is%20a%20bug%20because...%0A%0A%23%23%23%20Technical%20details%0A%0A*%20MathJax%20Version%3A%20master%20-%20latest%20commit%3A%20%20INSERT%20COMMIT%20REF%0A*%20Client%20OS%3A%20%0A*%20Browser%3A%20%0A*%20">click this link</a> to start creating a bug report with the template automatically.</p></li>
</ol>
<p>A good bug report shouldn’t leave others needing to request more information from you. Be sure to include the details of your environment.</p>
<p><a id="template"></a></p>
<p>Template Example (<a href="https://github.com/MathJax/MathJax/issues/new?title=Bug%3A&amp;body=%23%23%23%20Issue%20Summary%0A%0A%23%23%23%20Steps%20to%20Reproduce%0A%0A1.%20This%20is%20the%20first%20step%0A%0AThis%20is%20a%20bug%20because...%0A%0A%23%23%23%20Technical%20details%0A%0A*%20MathJax%20Version%3A%20master%20-%20latest%20commit%3A%20%20INSERT%20COMMIT%20REF%0A*%20Client%20OS%3A%20%0A*%20Browser%3A%20%0A*%20">click to use</a>):</p>
<pre><code>Short and descriptive example bug report title

### Issue Summary

A summary of the issue and the browser/OS environment in which it occurs. If
suitable, include the steps required to reproduce the bug.

### Steps to Reproduce

1. This is the first step
2. This is the second step
3. Further steps, etc.

Any other information you want to share that is relevant to the issue
being reported. Especially, why do you consider this to be a bug? What
do you expect to happen instead?

### Technical details:

* MathJax Version: 2.3 (latest commit: f3aaf3a2a3e964df2770dc4aaaa9c87ce5f47e2c)
* Client OS: Mac OS X 10.8.4
* Browser: Chrome 29.0.1547.57</code></pre>
</section>
<section id="feature-requests" class="level3">
<h3 class="anchored" data-anchor-id="feature-requests">Feature Requests</h3>
<p>Feature requests are welcome. Before you submit one, be sure to have:</p>
<ol type="1">
<li><strong>Used the GitHub search</strong> to check that the feature hasn’t already been requested.</li>
<li>Take a moment to think about whether your idea fits with the scope and aims of the project, or if it might better fit being a <a href="https://github.com/mathjax/MathJax-third-party-extensions">custom extension</a>.</li>
<li>Remember, it’s up to <em>you</em> to make a strong case to convince the project’s leaders of the merits of this feature. Please provide as much detail and context as possible, this means explaining the use case and why it is likely to be common.</li>
</ol>
</section>
<section id="change-requests" class="level3">
<h3 class="anchored" data-anchor-id="change-requests">Change Requests</h3>
<p>Change requests cover both architectural and functional changes to how MathJax works. If you have an idea for a new or different dependency, a refactor, or an improvement to a feature, etc., please be sure to:</p>
<ol type="1">
<li><strong>Use the GitHub search</strong> to check that someone else didn’t get there first.</li>
<li>Take a moment to think about the best way to make a case for, and explain what you’re thinking. Are you sure this shouldn’t really be a <a href="#bug-reports">bug report</a> or a <a href="#feature-requests">feature request</a>? Is it really one idea or is it many? What’s the context? What problem are you solving? Why is what you are suggesting better than what’s already there?</li>
</ol>
</section>
</section>
<section id="working-on-mathjax-core" class="level2">
<h2 class="anchored" data-anchor-id="working-on-mathjax-core">Working on MathJax core</h2>
<p>You want to contribute code? We describe how below. First, note that the MathJax source code is in the <a href="https://github.com/mathjax/MathJax-src" class="uri">https://github.com/mathjax/MathJax-src</a> repository, not the <a href="https://github.com/mathjax/MathJax" class="uri">https://github.com/mathjax/MathJax</a> repository, which contains the packaged component files for distribution on CDNs and the <a href="https://www.npmjs.com/package/mathjax">mathjax npm package</a> (the source code is included in the <a href="https://www.npmjs.com/package/mathjax-full">mathjax-full npm package</a>).</p>
<section id="key-branches-tags" class="level3">
<h3 class="anchored" data-anchor-id="key-branches-tags">Key Branches &amp; Tags</h3>
<p>MathJax uses several permanent branches in the <a href="https://github.com/mathjax/MathJax-src">MathJax source repository</a>:</p>
<ul>
<li><p><strong><a href="https://github.com/mathjax/MathJax-src/tree/develop">develop</a></strong> is the development branch. All work on the next release happens here so you should generally branch off <code>develop</code> if you are going to submit a pull request. Do <strong>NOT</strong> use this branch for a production site.</p></li>
<li><p><strong><a href="https://github.com/mathjax/MathJax-src">master</a></strong> contains the latest release of MathJax. This branch may be used in production. Do <strong>NOT</strong> use this branch to work on MathJax’s source.</p></li>
</ul>
<p>These branches reflect version 3 of MathJax, which is substantially different from the version 2 codebase. Version 2 will continue to be maintained while web sites transition to version 3, with work being done using the following branches in the <a href="https://github.com/mathjax/MathJax">MathJax distribution repository</a>:</p>
<ul>
<li><p><strong><a href="https://github.com/mathjax/MathJax/tree/legacy-v2-develop">legacy-v2-develop</a></strong> is the development branch for changes to the legacy version 2 code. Any pull requests for version 2 should be branched from here. Do <strong>NOT</strong> use this branch for a production site.</p></li>
<li><p><strong><a href="https://github.com/mathjax/MathJax/tree/legacy-v2">legacy-v2</a></strong> is the branch that contains any updates to version 2 following the release of version 3. Do <strong>NOT</strong> use this branch to work on MathJax’s source.</p></li>
</ul>
<p>In addition to these branches, MathJax uses tags to identify the various versions. These can be checked out to obtain the specified release; for example, <code>git checkout 2.7.5</code> would get you the files for version 2.7.5 of MathJax.</p>
<p>Note that version 3 is written in Typescript, and so must be compiled to obtain usable javascript files, and that the components need to be built once that is done. See the <a href="https://docs.mathjax.org/en/latest/web/hosting.html#getting-mathjax-via-git">documentation</a> for details. For version 2, the source javascript files are not compressed until a release is made, so you should use the copies in the <code>unpacked</code> directory during development.</p>
</section>
<section id="submitting-pull-requests" class="level3">
<h3 class="anchored" data-anchor-id="submitting-pull-requests">Submitting Pull Requests</h3>
<p>Pull requests are welcome. If you’re looking to submit a PR for something that doesn’t have an open issue, please consider <a href="#reporting-an-issue">raising an issue</a> that your PR can close, especially if you’re fixing a bug. This makes it more likely that there will be enough information available for your PR to be properly tested and merged.</p>
<section id="need-help" class="level5">
<h5 class="anchored" data-anchor-id="need-help">Need Help?</h5>
<p>If you’re not completely clear on how to submit/update/<em>do</em> Pull Requests, please check out our <a href="https://github.com/mathjax/MathJax/wiki/Source-control-policies">source control policies</a>. For more insights, check the excellent in depth <a href="https://github.com/TryGhost/Ghost/wiki/Git-Workflow">Git Workflow guide</a> from Ghost, in particular</p>
<ul>
<li><a href="https://github.com/TryGhost/Ghost/wiki/Git-workflow#commit-messages">Ghost Workflow guide: commit messages</a></li>
</ul>
</section>
</section>
<section id="testing-and-quality-assurance" class="level3">
<h3 class="anchored" data-anchor-id="testing-and-quality-assurance">Testing and Quality Assurance</h3>
<p>If you’re looking to get involved with the code base and don’t know where to start, checking out and testing a pull request is one of the most useful things you could do.</p>
<p>These are some <a href="https://gist.github.com/piscisaureus/3342247">excellent instructions</a> on configuring your GitHub repository to allow you to checkout pull requests in the same way as branches.</p>
</section>
<section id="writing-documentation" class="level3">
<h3 class="anchored" data-anchor-id="writing-documentation">Writing documentation</h3>
<p>MathJax’s main documentation can be found at <a href="http://docs.mathjax.org">docs.mathjax.org</a>. The source of the docs is hosted in the <a href="http://github.com/mathjax/MathJax-docs">mathjax/MathJax-docs</a> repo here on GitHub.</p>
<p>The documentation is generated using <a href="http://sphinx-doc.org/">Sphinx-doc</a> and hosted on <a href="http://readthedocs.org">Read the docs</a>. You can clone the repo and submit pull requests following the <a href="#submitting-pull-requests">pull-request</a> guidelines.</p>
</section>
<section id="translation" class="level3">
<h3 class="anchored" data-anchor-id="translation">Translation</h3>
<p>If you wish to add or update translations of MathJax, please do it on <a href="https://translatewiki.net/w/i.php?title=Special:Translate&amp;group=out-mathjax-0-all">TranslateWiki.net</a> (and while you’re there you can help other open source projects, too).</p>
<p>For bug reports and other questions that don’t fit on TranslateWiki.net, head over to the <a href="https://github.com/mathjax/MathJax-i18n">mathjax/mathjax-i18n</a> repository.</p>
<p>The translation files currently are for version 2, as localization hasn’t been added to version 3 yet.</p>
</section>
</section>
<section id="conduct" class="level2">
<h2 class="anchored" data-anchor-id="conduct">Conduct</h2>
<p>As a NumFOCUS fiscally sponsored project, MathJax is governed by the <a href="https://numfocus.org/code-of-conduct">NumFOCUS code of conduct</a>, which we summarize as follows:</p>
<p>We are committed to providing a friendly, safe and welcoming environment for all, regardless of gender, sexual orientation, disability, ethnicity, religion, or similar personal characteristic.</p>
<p>Please be kind and courteous. There’s no need to be mean or rude. Respect that people have differences of opinion and that every design or implementation choice carries a trade-off and numerous costs. There is seldom a right answer, merely an optimal answer given a set of values and circumstances.</p>
<p>Please keep unstructured critique to a minimum. If you have solid ideas you want to experiment with, make a fork and see how it works.</p>
<p>We will exclude you from interaction if you insult, demean or harass anyone. That is not welcome behaviour. We interpret the term “harassment” as including the definition in the <a href="https://numfocus.org/code-of-conduct#unacceptable-behavior">Unacceptable Behavior</a> section of the <a href="https://numfocus.org/code-of-conduct">NumFOCUS code of conduct</a>; if you have any lack of clarity about what might be included in that concept, please read that definition. In particular, we don’t tolerate behavior that excludes people in socially marginalized groups.</p>
<p>Private harassment is also unacceptable. No matter who you are, if you feel you have been or are being harassed or made uncomfortable by a community member, please contact one of the channel ops or any of the <a href="https://github.com/MathJax/MathJax">MathJax</a> core team immediately. Whether you’re a regular contributor or a newcomer, we care about making this community a safe place for you and we’ve got your back.</p>
<p>Likewise any spamming, trolling, flaming, baiting, or other attention-stealing behaviour is not welcome.</p>
<p>We also recommend that you read <a href="http://blog.discourse.org/2013/03/the-universal-rules-of-civilized-discourse/">discourse’s rules</a> for further suggestions on appropriate behavior.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li>We heavily borrowed from Mozilla and Ghost – thank you!
<ul>
<li><a href="https://github.com/TryGhost/Ghost/blob/master/CONTRIBUTING.md" class="uri">https://github.com/TryGhost/Ghost/blob/master/CONTRIBUTING.md</a></li>
<li><a href="https://github.com/mozilla/rust/wiki/Note-development-policy" class="uri">https://github.com/mozilla/rust/wiki/Note-development-policy</a></li>
</ul></li>
<li><a href="https://github.com/jden/CONTRIBUTING.md/blob/master/CONTRIBUTING.md" class="uri">https://github.com/jden/CONTRIBUTING.md/blob/master/CONTRIBUTING.md</a></li>
<li><a href="http://blog.discourse.org/2013/03/the-universal-rules-of-civilized-discourse/" class="uri">http://blog.discourse.org/2013/03/the-universal-rules-of-civilized-discourse/</a></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "已复制");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "已复制");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>